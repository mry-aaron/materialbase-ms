<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8">
    <title>MaterialBaseRecord</title>

    <!-- 引入CSS样式表 -->
    <link rel="stylesheet" href="http://192.168.0.125/css/reset.css">
    <link rel="stylesheet" href="http://192.168.0.125/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://192.168.0.125/css/styles.css">
    <link rel="stylesheet" href="http://192.168.0.125/css/media.css">
    <link rel="stylesheet" href="http://192.168.0.125/layui/css/layui.css">
    <link rel="stylesheet" href="http://192.168.0.125/css/materialbase.css">

</head>
<body>
<!-- 头部信息 -->
<div class="header">
    <!-- 顶部导航栏 -->
    <div th:replace="~{pages/iframe/navbar.html::topNav}"></div>
</div>

<!-- 主体信息 -->
<div class="main-container">
    <!-- 左侧导航栏 -->
    <div th:replace="~{pages/iframe/navbar::leftNav(activeUri='record.html')}"></div>
    <!-- 主体内容 -->
    <div class="content">
        <div class="container-fluid">
            <div class="row">
                <div><span>录入</span>素材文件</div>
            </div>
            <div class="formItem">
                <form th:action="@{/record}" method="post" enctype="multipart/form-data" lay-filter="example" class="layui-form">
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">公司名</label>
                            <div class="layui-input-block">
                                <input type="text" name="cName" autocomplete="off" required placeholder="请输入或选择公司名称" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">产品名</label>
                            <div class="layui-input-block">
                                <input type="text" name="productName" autocomplete="off" required placeholder="请输入产品名称" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">产品题材</label>
                            <div class="layui-input-block">
                                <input type="text" name="productTheme" autocomplete="off" required placeholder="请输入产品题材" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">素材风格</label>
                            <div class="layui-input-block">
                                <select name="smStyleId"></select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">素材尺寸</label>
                            <div class="layui-input-block">
                                <input type="text" name="size" autocomplete="off" required placeholder="如：1366*768" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">素材类型</label>
                            <div class="layui-input-block">
                                <select name="smTypeId"></select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">媒体</label>
                            <div class="layui-input-block">
                                <select name="mediaId"></select>
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">素材平台</label>
                            <div class="layui-input-block">
                                <input type="text" name="platform" autocomplete="off" required placeholder="请输入素材平台" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">素材星级</label>
                            <div class="layui-input-block">
                                <input type="text" name="starLevel" autocomplete="off" required placeholder="1 / 2 / 3 / 4 / 5 " class="layui-input">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">素材消耗</label>
                            <div class="layui-input-block">
                                <input type="text" name="consume" autocomplete="off" required placeholder="请输入素材消耗" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">素材路径</label>
                            <div class="layui-input-block">
                                <input type="text" class="layui-input fileName" placeholder="请浏览素材文件" readonly/>
                                <input type="file" name="file" id="upload_file" hidden />
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label img_btn" for="upload_file">浏览...</label>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" lay-filter="demo1">录入素材</button>
                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                    </div>
                </form>
                <div class="record_result" hidden>[[${session.recordResult}]]</div>
            </div>
        </div>
    </div>

</div>
</body>
<!-- 引入JS库 -->
<script type="text/javascript" src="http://192.168.0.125/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="http://192.168.0.125/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://192.168.0.125/js/carbon.js"></script>
<script type="text/javascript" src="http://192.168.0.125/layui/layui.js"></script>
<script type="text/javascript">
    layui.use("table");
    // 浏览文件名展示
    $("#upload_file").on("change", function () {
        // 验证文件大小不能超过50MB
        var f = document.getElementById("upload_file").files;
        if(f[0].size / 1024 > 50 * 1024){
            layui.use('layer', function(){
                var active = {
                    confirmTrans: function(){
                        layer.msg('文件不能超过50MB' , {
                            time: 2000
                        });
                    }
                };
                active['confirmTrans'] ? active['confirmTrans'].call(this) : '';
            });
            return false;
        }
        $(".fileName").val($(this).val());
    });

</script>
<script type="text/javascript" src="http://192.168.0.125/js/materialbase.js"></script>
<script type="text/javascript" src="http://192.168.0.125/js/init_selectload.js"></script>
<!-- JS监听屏幕改变 -->
<script type="text/javascript" src="http://192.168.0.125/js/screen_set.js"></script>
<script type="text/javascript">
    // 加载素材风格
    loadSelectItem("POST", "/getstyle", "select[name='smStyleId']", "sName");
    // 加载素材类型
    loadSelectItem("POST", "/gettype", "select[name='smTypeId']", "tName");
    // 加载媒体
    loadSelectItem("POST", "/getmedia", "select[name='mediaId']", "mName");
</script>

<!-- 弹出录入结果 -->
<script type="text/javascript">
    $(function () {
        function recordResult(_msg) {
            layui.use('layer', function(){
                var active = {
                    confirmTrans: function(){
                        layer.msg(_msg , {
                            time: 2000, //2s后自动关闭
                            //btn: ['确定']
                        });
                    }
                };
                active['confirmTrans'] ? active['confirmTrans'].call(this) : '';
            });
        }
        var $result = $(".record_result").html();
        if($result == "success"){
            recordResult("素材录入成功！<br/>请继续您的操作！");
        } else if($result == "error"){
            recordResult('素材录入失败！<br/>请重新录入信息！');
        }
    });
</script>
</html>